<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T5_GeneSetAnalysis • franciscomartinez</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="T5_GeneSetAnalysis">
<meta property="og:description" content="franciscomartinez">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">franciscomartinez</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/T1_Microarray.html">T1_Microarray</a>
    </li>
    <li>
      <a href="../articles/T2_ExprDiferencial.html">T2_ExprDiferencial</a>
    </li>
    <li>
      <a href="../articles/T3_RNAseq.html">T3_RNAseq</a>
    </li>
    <li>
      <a href="../articles/T4_Sobrerrepresentacion.html">T4_Sobrerrepresentacion</a>
    </li>
    <li>
      <a href="../articles/T5_GeneSetAnalysis.html">T5_GeneSetAnalysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="T5_GeneSetAnalysis_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>T5_GeneSetAnalysis</h1>
                        <h4 class="author">Francisco Martínez Picó</h4>
            
            <h4 class="date">7/14/2020</h4>
      
      
      <div class="hidden name"><code>T5_GeneSetAnalysis.Rmd</code></div>

    </div>

    
    
<p>En esta viñeta se muestra el <strong>análisis de grupos de genes</strong> tanto del experimento de <em>Microarrays (gse69762)</em> como del experimento de <em>RNAseq (PRJNA601724)</em> (para obtener más información de estos estudios ir a las viñetas correspondientes). Es decir, se tratará de estudiar si hay relación entre un grupo de genes previamente definido y el fenotipo observado. En esta aproximación no usamos ningún conocimiento previo sobre relaciones conocidas entre genes que podrían ser esenciales a la hora de determinar la asociación conjunto de genes - fenotipo y no sólo gen - fenotipo</p>
<p>Más concretamente, se puede utilizar el concepto de <strong>enriquecimiento</strong> o <strong>GSEA</strong> (<em>Gene Set Enrichment Analysis</em>). Esto es debido a que este método trata de resumir o enriquecer la señal que da cada uno de los genes cogiendo el grupo.</p>
<p>Información sobre este procedimiento puede ser encontrada en:</p>
<ul>
<li><p>Aravind Subramanian y col. «Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide ex- pression profiles». En: <em>Proceedings of the National Academy of Sciences of the United States of America</em> 102.43 (2005), págs. 15545-15550. doi: 10.1073/pnas.0506580102.</p></li>
<li><p>R.A. Irizarry y col. «Gene set enrichment analysis made sim- ple». En: <em>Statistical Methods in Medical Research</em> 18.6 (2009). Gene set analysis, págs. 565-575.</p></li>
</ul>
<p>La información respecto a los grupos de genes han sido obtenidas de la <strong>base de datos KEGG</strong> (<em>Kyoto Encyclopedia of Genes and Genomes</em>).</p>
<p>Se utilizará el método implementado en el paquete <strong>GSA</strong>. Este utiliza la distribución de permutación a la que se aplica una reestandarización. La medida de enriquecimiento que proponen por defecto es la llamada <strong>maxmean</strong> (se toma la media de las partes positivas t+i, la media de las partes negativas t-i y nos quedamos con el máximo de ambos valores).</p>
<div id="cargando-paquetes" class="section level2">
<h2 class="hasAnchor">
<a href="#cargando-paquetes" class="anchor"></a>Cargando paquetes</h2>
<p>Antes de empezar, cargamos los paquetes necesarios:</p>
<ul>
<li>
<em>Biobase</em>: este paquete para trabajar con Bioconductor contiene estructuras estandarizadas de datos para representar información genómica.</li>
<li>
<em>SummarizedExperiment</em>: paquete utilizado para trabajar con el objeto RangedSummarizedExperiment, que contendrá toda la información de nuestro experimento de RNAseq.</li>
<li>
<em>GSA</em>: paquete utilizado para llevar a cabo este estudio de GSEA. Lleva implementado los métodos que utilizaremos.</li>
<li>
<em>EnrichmentBrowser</em>: utilizado para la descarga de grupos de genes de las BBDD que queramos (en este caso, KEGG).</li>
<li>
<em>org.Ce.eg.db</em>: para realizar la anotación de los genes del experimento de RNAseq. Este experimento se realiza sobre <em>C. elegans</em>. Los ID incluidos son los de WormBase y necesitamos los ENTREZ.</li>
<li>
<em>AnnotationDbi</em>: para llevar a cabo la anotación mencionada anteriormente de los ID de ENTREZ.</li>
<li>
<em>franciscomartinez</em>: el paquete que se está realizando para utilizar la función getGroupName.</li>
<li>
<em>tami</em>: para comparar hipótesis competitiva con hipótesis autocontenida.</li>
</ul>
</div>
<div id="microarray" class="section level1">
<h1 class="hasAnchor">
<a href="#microarray" class="anchor"></a>Microarray</h1>
<p>Cargamos los datos del experimento de Microarrays <strong>gse69762</strong>, correspondientes a la <em>Tarea 1</em>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">gse69762</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">'franciscomartinez'</span>)</pre></body></html></div>
<p>Descargamos los grupos de genes para <em>Homo sapiens</em> de la base de datos KEGG.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">hsaKEGGgsc</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">'hsa'</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">'kegg'</span>) <span class="co"># Bajamos info de grupos de genes para Homo sapiens y la base de datos KEGG</span></pre></body></html></div>
<p>Se definen los grupos experimentales con valores 1 y 2. Esto es un requisito del paquete GSA.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">f1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">1</span>,<span class="fl">4</span>)
<span class="no">f2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">2</span>,<span class="fl">5</span>)
<span class="no">f3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">1</span>,<span class="fl">4</span>)
<span class="no">f4</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">2</span>,<span class="fl">4</span>)
<span class="no">f5</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">1</span>,<span class="fl">6</span>)
<span class="no">f6</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">2</span>,<span class="fl">7</span>)

<span class="no">grupo</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">f1</span>,<span class="no">f2</span>,<span class="no">f3</span>,<span class="no">f4</span>,<span class="no">f5</span>,<span class="no">f6</span>)</pre></body></html></div>
<div id="aplicando-el-método-gsa" class="section level2">
<h2 class="hasAnchor">
<a href="#aplicando-el-m%C3%A9todo-gsa" class="anchor"></a>Aplicando el método GSA</h2>
<p>Y realizamos el análisis con GSA. Este método considera la <strong>hipótesis autocontenida</strong> (¿tiene nuestro grupo de genes una expresión diferencial asociada a las variables fenotípicas?) y fue propuesto en la siguiente referencia:</p>
<ul>
<li>Bradley Efron y Robert Tibshirani. «On testing the significan- ce of sets». En: <em>Annals of Applied Statistics</em> 1.1 (2007). Gene set analysis, págs. 107-129. doi: 10.1214/07-AOAS101.</li>
</ul>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">gse69762.gsa</span> <span class="kw">=</span> <span class="fu">GSA</span>(<span class="fu">exprs</span>(<span class="no">gse69762</span>), <span class="no">grupo</span>, <span class="kw">genenames</span> <span class="kw">=</span> <span class="fu">fData</span>(<span class="no">gse69762</span>)<span class="kw">[[</span><span class="st">'ENTREZID'</span>]], <span class="kw">genesets</span> <span class="kw">=</span> <span class="no">hsaKEGGgsc</span>, <span class="kw">resp.type</span> <span class="kw">=</span> <span class="st">"Two class unpaired"</span>, <span class="kw">nperms</span><span class="kw">=</span><span class="fl">100</span>)</pre></body></html></div>
<p>Para visualizar los estadísticos enriquecidos para los grupos:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">GSA.scores</span>)</pre></body></html></div>
<p>Para observar los p-valores obtenidos para lo llamado <strong>genes negativos</strong> (genes que corresponden con genes que en la clase 2 tiene expresiones menores).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">pvalues.lo</span>)</pre></body></html></div>
<p>Para observar los p-valores obtenidos para lo llamado <strong>genes positivos</strong> (genes que corresponden con genes que en la clase 2 tiene expresiones mayor).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">pvalues.hi</span>)</pre></body></html></div>
<p>Los valores originales ti los tenemos con:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">gene.scores</span>)</pre></body></html></div>
<p>Observamos valores NA, serán genes que no aparecen en ninguno de los grupos seleccionados de la base de datos KEGG.</p>
</div>
<div id="analizando-los-resultados" class="section level2">
<h2 class="hasAnchor">
<a href="#analizando-los-resultados" class="anchor"></a>Analizando los resultados</h2>
<p>Fijamos una tasa de error al 0,05. Vemos qué grupos presentan una asociación negativa o positiva con mayor diferencia significativa entre nuestros grupos.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">ind.lo</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">pvalues.lo</span> <span class="kw">&lt;</span> <span class="fl">0.05</span>) <span class="co"># Negativa</span>
<span class="no">ind.hi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">gse69762.gsa</span>$<span class="no">pvalues.hi</span> <span class="kw">&lt;</span><span class="fl">0.05</span>) <span class="co"># Positiva</span></pre></body></html></div>
<p>Para visualizar los identificadores KEGG para los grupos que tienen <strong>asociación negativa</strong>:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>[<span class="no">ind.lo</span>])</pre></body></html></div>
<p>Para visualizar los identificadores KEGG para los grupos que tienen <strong>asociación positiva</strong>:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>[<span class="no">ind.hi</span>])</pre></body></html></div>
<p>Sin embargo, si únicamente queremos saber el identificador del grupo (y no obtener con éste la información descriptiva del mismo) podemos modificar los nombres que obtiene la función getGenesets de la siguiente manera:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>),<span class="no">getGroupName</span>)</pre></body></html></div>
<p>Y se vuelve a mostrar lo mismo, obteniendo ahora únicamente el identificador del grupo.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>[<span class="no">ind.hi</span>])</pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hsaKEGGgsc</span>[<span class="no">ind.hi</span>])</pre></body></html></div>
<p>Estos son los datos que deberían ser interpretados por un especialista en esta enfermedad. Se observa una expresión diferencial en grupos de genes relacionados con el <strong>metabolismo de diferentes metabolitos</strong> (ciertos aminoácidos como la valina, propanoato) y algunos <strong>procesos relacionados con el sistema inmune</strong> (autofagia, fagosomas, activación de plaquetas, procesos inflamatorios…).</p>
</div>
</div>
<div id="rnaseq" class="section level1">
<h1 class="hasAnchor">
<a href="#rnaseq" class="anchor"></a>RNAseq</h1>
<p>Cargamos los datos del experimento de RNAseq <strong>PRJNA601724</strong>, correspondientes a la <em>Tarea 3</em>.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">'PRJNA601724'</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">'franciscomartinez'</span>)</pre></body></html></div>
<p>Como tenemos tres grupos y los métodos están preparados para trabajar únicamente con dos, decidimos trabajar arbitrariamente sólo con los grupos de <em>E.coli</em> y <em>Chryseobacterium</em>.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">sel</span> <span class="kw">=</span> <span class="fu">colData</span>(<span class="no">PRJNA601724</span>)[,<span class="st">"Treatment"</span>] <span class="kw">==</span> <span class="st">"E.coli"</span> <span class="kw">|</span>
  <span class="fu">colData</span>(<span class="no">PRJNA601724</span>)[,<span class="st">"Treatment"</span>] <span class="kw">==</span> <span class="st">"Chryseobacterium"</span>

<span class="no">sel</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sel</span>)

<span class="no">nuevo_se</span> <span class="kw">=</span> <span class="no">PRJNA601724</span>[,<span class="no">sel</span>]</pre></body></html></div>
<p>A continuación, descargamos los grupos de genes. De nuevo realizamos esta descarga utilizando la función getGenesets() del paquete EnrichmentBrowser de la base de datos KEGG, pero en esta ocasión para el organismo objeto de nuestro estudio (<em>C. elegans</em>).</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">celKEGGgsc</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">'cel'</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">'kegg'</span>) <span class="co"># Para C. elegans y la base de datos KEGG.</span></pre></body></html></div>
<p>Seguidamente pasamos a añadir los ENTREZ ID a nuestros datos, ya que con los ID de WormBase (los cuales ya están incluídos) no es suficiente. Esto es debido a que la información de grupos de genes descargada de KEGG viene con los ID de ENTREZ.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Para añadir más información de anotación de los genes:</span>
<span class="no">genesInfo</span> <span class="kw">=</span> <span class="kw pkg">AnnotationDbi</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">select</a></span>(<span class="no">org.Ce.eg.db</span>, <span class="kw">keys</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">nuevo_se</span>), <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ENTREZID"</span>, <span class="st">"SYMBOL"</span>), <span class="kw">keytype</span> <span class="kw">=</span> <span class="st">"WORMBASE"</span>)

<span class="co"># Nos quedamos con la primera coincidencia de WormBase:</span>
<span class="no">posiciones</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">genesInfo</span>[,<span class="fl">1</span>]),<span class="no">genesInfo</span>[,<span class="fl">1</span>]) <span class="co"># Para WORMBASE</span>
<span class="no">genesInfo</span> <span class="kw">=</span> <span class="no">genesInfo</span>[<span class="no">posiciones</span>,]</pre></body></html></div>
<p>Ahora reasignamos los grupos experimentales que utilizaremos para este análisis, ya que la función GSA necesita que estén reasignados como “1” y “2”.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">f1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">1</span>,<span class="fl">3</span>)
<span class="no">f2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="fl">2</span>,<span class="fl">3</span>)

<span class="no">grupo</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">f1</span>,<span class="no">f2</span>)</pre></body></html></div>
<p>Finalmente, se realiza el análisis GSA.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">PRJNA601724.gsa</span> <span class="kw">=</span> <span class="fu">GSA</span>(<span class="fu">assay</span>(<span class="no">PRJNA601724</span>), <span class="no">grupo</span>, <span class="kw">genenames</span> <span class="kw">=</span> <span class="no">genesInfo</span><span class="kw">[[</span><span class="st">'ENTREZID'</span>]], <span class="kw">genesets</span> <span class="kw">=</span> <span class="no">celKEGGgsc</span>, <span class="kw">resp.type</span> <span class="kw">=</span> <span class="st">"Two class unpaired"</span>, <span class="kw">nperms</span><span class="kw">=</span><span class="fl">100</span>)</pre></body></html></div>
<div id="analizando-los-resultados-1" class="section level2">
<h2 class="hasAnchor">
<a href="#analizando-los-resultados-1" class="anchor"></a>Analizando los resultados</h2>
<p>Fijamos una tasa de error al 0,05. Vemos qué grupos presentan una asociación negativa o positiva con mayor diferencia significativa entre nuestros grupos.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">ind.lo</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">PRJNA601724.gsa</span>$<span class="no">pvalues.lo</span> <span class="kw">&lt;</span> <span class="fl">0.05</span>) <span class="co"># Negativa</span>
<span class="no">ind.hi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">PRJNA601724.gsa</span>$<span class="no">pvalues.hi</span> <span class="kw">&lt;</span><span class="fl">0.05</span>) <span class="co"># Positiva</span></pre></body></html></div>
<p>Para visualizar los identificadores KEGG para los grupos que tienen <strong>asociación negativa</strong>:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>[<span class="no">ind.lo</span>])</pre></body></html></div>
<p>Para visualizar los identificadores KEGG para los grupos que tienen <strong>asociación positiva</strong>:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>[<span class="no">ind.hi</span>])</pre></body></html></div>
<p>Sin embargo, si únicamente queremos saber el identificador del grupo (y no obtener con éste la información descriptiva del mismo) podemos modificar los nombres que obtiene la función getGenesets de la siguiente manera:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>),<span class="no">getGroupName</span>)</pre></body></html></div>
<p>Y se vuelve a mostrar lo mismo, obteniendo ahora únicamente el identificador del grupo.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>[<span class="no">ind.lo</span>])</pre></body></html></div>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">celKEGGgsc</span>[<span class="no">ind.hi</span>])</pre></body></html></div>
<p>De nuevo, estos datos deberían ser interpretados por un especialista. Se puede observar que hay genes implicados en el <strong>metabolismo general</strong> (degradación de DNA, RNA, proteosoma, spliceosoma…) así como el <strong>crecimiento celular</strong> (RNA polimerasa, transporte de RNA, reparación de bases).</p>
</div>
</div>
<div id="hipótesis-competitiva-vs-hipótesis-autocontenida-un-ejemplo" class="section level1">
<h1 class="hasAnchor">
<a href="#hip%C3%B3tesis-competitiva-vs-hip%C3%B3tesis-autocontenida-un-ejemplo" class="anchor"></a>Hipótesis competitiva vs Hipótesis autocontenida: un ejemplo</h1>
<p>Se define como <strong>hipótesis competitiva</strong> el plantear que nuestro grupo de genes tiene el mismo patrón de asociación con el fenotipo comparado con el resto de genes. Por otro lado, con la <strong>hipótesis autocontenida</strong> nos planteamos que nuestro grupo de genes no contiene algún gen cuyos niveles de expresión están asociados a las variables fenotípicas.</p>
<p>A continuación se utilizará el paquete tami para realizar el mismo anaálisis de grupos de genes pero teniendo en cuenta, por un lado, la hipótesis competitiva y, por otro lado, la hipótesis autocontenida. Los datos que se utilizarán serán los del ExpressionSet gse69762 anterior. Los grupos en este caso serán obtenidos de la base de datos <em>GeneOntology</em>.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">hsaGOgsc</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">'hsa'</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">'go'</span>) <span class="co"># Bajamos info de grupos de genes para Homo sapiens y la base de datos GO</span></pre></body></html></div>
<p>Se realiza el análisis con la <strong>hipótesis competitiva</strong>. El estadístico será, al igual que el caso anterior, el maxmean.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12345</span>)
<span class="no">competitive</span> <span class="kw">=</span> <span class="fu">GeneSetTest</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">gse69762</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"type"</span>,
                 <span class="kw">test</span> <span class="kw">=</span> <span class="no">rowt</span>, <span class="kw">association</span> <span class="kw">=</span> <span class="st">"pvalue"</span>, <span class="kw">correction</span> <span class="kw">=</span> <span class="st">"BH"</span>,
                 <span class="kw">GeneNullDistr</span> <span class="kw">=</span> <span class="st">"randomization"</span>,
                 <span class="kw">GeneSetNullDistr</span> <span class="kw">=</span> <span class="st">"competitive"</span>,
                 <span class="kw">alternative</span> <span class="kw">=</span> <span class="st">"two-sided"</span>, <span class="kw">nmax</span> <span class="kw">=</span> <span class="fl">100</span>,
                 <span class="kw">id</span> <span class="kw">=</span> <span class="st">"ENTREZID"</span>, <span class="kw">gsc</span> <span class="kw">=</span> <span class="no">hsaGOgsc</span>, <span class="kw">descriptive</span> <span class="kw">=</span> <span class="no">maxmean</span>,
                 <span class="kw">minsize</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">maxsize</span> <span class="kw">=</span> <span class="fl">200</span>,
                 <span class="kw">foutput</span> <span class="kw">=</span> <span class="st">"competitive"</span>)
<span class="no">dfcompet</span> <span class="kw">=</span> <span class="fu">tidy</span>(<span class="no">competitive</span>)</pre></body></html></div>
<p>Para un alfa de 0,01, 39 grupos de genes tendrían una expresión diferencial signficativa bajo la hipótesis competitiva.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">dfcompet</span>$<span class="no">adjp</span> <span class="kw">&lt;</span> <span class="fl">0.01</span>)</pre></body></html></div>
<p>Se realiza el análisis con la <strong>hipótesis autocontenida</strong> El estadístico será, al igual que el caso anterior, el maxmean.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12345</span>)
<span class="no">self.contained</span> <span class="kw">=</span> <span class="fu">GeneSetTest</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">gse69762</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"type"</span>,
                 <span class="kw">test</span> <span class="kw">=</span> <span class="no">rowt</span>, <span class="kw">association</span> <span class="kw">=</span> <span class="st">"pvalue"</span>, <span class="kw">correction</span> <span class="kw">=</span> <span class="st">"BH"</span>,
                 <span class="kw">GeneNullDistr</span> <span class="kw">=</span> <span class="st">"randomization"</span>,
                 <span class="kw">GeneSetNullDistr</span> <span class="kw">=</span> <span class="st">"self-contained"</span>,
                 <span class="kw">alternative</span> <span class="kw">=</span> <span class="st">"two-sided"</span>, <span class="kw">nmax</span> <span class="kw">=</span> <span class="fl">100</span>,
                 <span class="kw">id</span> <span class="kw">=</span> <span class="st">"ENTREZID"</span>, <span class="kw">gsc</span> <span class="kw">=</span> <span class="no">hsaGOgsc</span>, <span class="kw">descriptive</span> <span class="kw">=</span> <span class="no">maxmean</span>,
                 <span class="kw">minsize</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">maxsize</span> <span class="kw">=</span> <span class="fl">200</span>,
                 <span class="kw">foutput</span> <span class="kw">=</span> <span class="st">"self.contained"</span>)
<span class="no">dfself</span> <span class="kw">=</span> <span class="fu">tidy</span>(<span class="no">self.contained</span>)</pre></body></html></div>
<p>En este caso, para un alfa de 0,01, 192 grupos de genes tendrían una expresión diferencial signficativa bajo la hipótesis autocontenida</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">dfself</span>$<span class="no">adjp</span> <span class="kw">&lt;</span> <span class="fl">0.01</span>)</pre></body></html></div>
<p>Es decir, se puede observar que la significación de los grupos varía según la hipótesis que consideremos (39 bajo la hipótesis competitiva vs 192 bajo la hipótesis autocontenida.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Francisco Martinez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
